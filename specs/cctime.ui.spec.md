
# Назначение

Данный файл описывает спецификацию пользовательского интерфейса программы для управления расписанием занятости специалистов по времени и кабинетам.

Минимальная поддерживаемая ширина экрана — 360px.

Всем DOM-элементам присваивать ID для удобства ссылок и коммуникации.

# Конфигурация UI

UI должен брать конфигурацию из файла ui.config.json, доступного по относительному пути размещения приложения.

структура ui.config.json:
```json
{
    "api_url": "https://localhost:8080"
}
```

# Сущности

см. файл `cctime.api.spec.md`

Специалист и клиент с именем «-» обозначают «свободно» и имеют id = `00000000-0000-0000-0000-000000000001`

Все справочники (специалисты, клиенты, кабинеты, тайм-слоты) отображаются в порядке `orderIndex` (по возрастанию). Это позволяет размещать часто используемых специалистов/клиентов выше в выпадающих списках.


# Пользовательский интерфейс

## Основные положения

Интерфейс должен быть адаптирован для работы в браузере телефона и работе пальцами. Минимальная ширина — 360px. Стиль — приятный, аккуратный.

### Цветовая палитра

Основные цвета:
- `#20686c` — primary (тёмный тил), шапка, кнопки, заголовки
- `#005236` — accent-dark (тёмно-зелёный), active-состояния кнопок, подтверждения
- `#6bc4a6` — accent (мятный), выделения, активные элементы
- `#fe982a` — warning (оранжевый), акценты предупреждений
- `#bc4f07` — error/break (тёмно-оранжевый), ошибки, текст перерывов

Производные:
- `#d6efed` — primary-light, фон подвала, лёгкие подложки
- `#d4f0e4` — success, фон ячеек с двумя подтверждениями
- `#f7faf9` — bg, фон страницы
- `#c8dbd7` — border, рамки и разделители
- `#2a3a38` — text, основной цвет текста
- `#6b7e7a` — text-light, приглушённый текст
- `#fff1e0` — break, фон перерывов
- `#eef0ef` — past, фон прошедших дат
- `#a0aba8` — past-text, текст прошедших дат

## Страницы

### Страница расписания на день

Структура:
- шапка
- рабочая область
- подвал

#### Шапка

Верхняя строка (навигация):
- `«` — назад на неделю (этот же день недели, предыдущая неделя)
- `‹` — назад на день (предыдущий день)
- кнопка «Сегодня» (переход к текущей дате) + кнопка `▼` (открывает нативный календарь браузера для выбора произвольной даты)
- `›` — вперёд на день (следующий день)
- `»` — вперёд на неделю (этот же день недели, следующая неделя)

Под кнопкой «Сегодня» отображается диапазон текущей недели в формате {дд.мм} — {дд.мм.гггг} (понедельник — воскресенье).

Навигация по дням бесконечна в обе стороны.

#### Рабочая область

Состоит из колонок:
- колонка времени (узкая). Время отображается в две строки: время начала (жирный, крупный) сверху, время окончания (мелкий, приглушённый) снизу
- заголовок: дата в формате {дд.мм.гггг} + {название дня недели}
    - колонка кабинета 1
    - колонка кабинета 2
    - ...
    - колонка кабинета n

Шрифт в ячейках крупный, ячейки заполняют свободное пространство.

Строками являются временные интервалы, загружаемые из конфигурации (`timeSlots`).

Строки с типом `break` (перерывы, обед) отображаются как визуальные разделители с цветовым выделением. Резервирование для перерывов недоступно.

В пересечении кабинета и рабочего интервала времени выводятся сведения о резерве:
- первая строка — специалист, указанный в резерве
- вторая строка — клиент, указанный в резерве

Поведение:
- При клике на область резерва открывается страница редактирования (или создания, если резерва нет).
- Свайп влево/вправо по рабочей области переключает дату на следующий/предыдущий день (аналогично кнопкам `‹` / `›`).
- При свайпе вверх/вниз скроллится только рабочая область.

#### Прошлые даты

Резервы в прошлом (ранее текущей даты) выделяются цветом. При открытии страницы редактирования кнопка «сохранить» отсутствует.

### Страница создания/редактирования резерва

Может быть выполнена как popup или как самостоятельная страница. Доступные элементы:

- выбор специалиста (выпадающий список)
- количество резервов специалиста (целое положительное число) — сколько будущих недель тиражировать этого специалиста в данном кабинете, в этот день недели, в это время
- галочка «подтверждено» для специалиста + кнопка «поделиться» (иконка рядом с галочкой)
- выбор клиента (выпадающий список)
- количество резервов клиента (целое положительное число) — сколько будущих недель тиражировать этого клиента в данном кабинете, в этот день недели, в это время
- галочка «подтверждено» для клиента + кнопка «поделиться» (иконка рядом с галочкой)

При создании и при редактировании количество резервов по умолчанию заполняется значением 1. Пользователь может изменить.

Кнопки управления:
- сохранить (отсутствует для резервов в прошлом)
- закрыть

#### Кнопки «Поделиться» (Web Share API)

Рядом с каждой галочкой подтверждения размещается иконка «поделиться». При нажатии используется Web Share API (`navigator.share`) для отправки текстового сообщения в мессенджер (Telegram и т.п.).

Шаблоны текста:
- **Для специалиста:** `{имя клиента} подтвердил занятие {дата} {интервал}`
- **Для клиента:** `Вы придёте на {название кабинета} {дата} в {интервал}?`

Цепочка fallback при отправке:
1. `navigator.share()` (Web Share API) — предпочтительный способ
2. `navigator.clipboard.writeText()` — копирование в буфер обмена
3. `document.execCommand('copy')` через скрытый textarea — для контекстов без secure context (file://, HTTP)

При успешном копировании в буфер — уведомление пользователю «Скопировано в буфер обмена».

#### Логика сохранения

При сохранении отправляется запрос `SaveReserve` на сервер. После успешного ответа клиент повторно запрашивает `GetReservesForDate` для обновления расписания. Если ответ содержит ошибки (`errors`), они отображаются пользователю (например, конфликты при тиражировании). Проверка конфликтов выполняется на стороне сервера.

**Подтверждения и цветовое выделение:**
- Параметры подтверждения (`clientConfirmed`, `specialistConfirmed`) в будущих тиражированных резервах всегда устанавливаются в `false`.
- Подтверждения никогда не тиражируются.
- Если оба подтверждения (`clientConfirmed` и `specialistConfirmed`) установлены в `true`, вся ячейка резерва заливается зелёным цветом.
- Если подтверждён только один из двух — ячейка отображается без изменений (стандартный фон).

**Удаление:**
Операции удаления нет. Для очистки резерва пользователь выбирает специалиста/клиента «-» (`00000000-0000-0000-0000-000000000001`), что означает «свободно».

#### Подвал

Отображаются две ссылки-перехода:
- «Клиенты» — переход на страницу управления клиентами
- «Специалисты» — переход на страницу управления специалистами

### Страница специалистов

Отображает полный список специалистов (включая запись «-» с id = `00000000-0000-0000-0000-000000000001`), загружаемый через эндпоинт `GetSpecialists`. Список отсортирован по `orderIndex`.

Каждый элемент списка показывает:
- имя специалиста
- признак «архивный» (визуальная метка, например приглушённый текст или бейдж)

Кнопка «Добавить» — открывает попап создания нового специалиста.

При нажатии на элемент списка открывается попап редактирования с полями:
- имя (текстовое поле)
- порядок отображения (числовое поле, `orderIndex`)
- архивный (галочка, `isArchived`)
- кнопка «Сохранить» — вызывает `SaveSpecialist`
- кнопка «Закрыть»

После сохранения список обновляется повторным вызовом `GetSpecialists`.

В подвале — ссылка «Расписание» для возврата на главную страницу.

### Страница клиентов

Отображает полный список клиентов (включая запись «-» с id = `00000000-0000-0000-0000-000000000001`), загружаемый через эндпоинт `GetClients`. Список отсортирован по `orderIndex`.

Каждый элемент списка показывает:
- имя клиента
- признак «архивный» (визуальная метка, например приглушённый текст или бейдж)

Кнопка «Добавить» — открывает попап создания нового клиента.

При нажатии на элемент списка открывается попап редактирования с полями:
- имя (текстовое поле)
- порядок отображения (числовое поле, `orderIndex`)
- архивный (галочка, `isArchived`)
- кнопка «Сохранить» — вызывает `SaveClient`
- кнопка «Закрыть»

После сохранения список обновляется повторным вызовом `GetClients`.

В подвале — ссылка «Расписание» для возврата на главную страницу.
